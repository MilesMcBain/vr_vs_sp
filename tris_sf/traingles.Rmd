---
title: "Spatial to VR with R"
author: "Miles McBain"
output: html_document
---

```{r}
library(sf)
nc <- read_sf(system.file("shape/nc.shp", package="sf"))
```

# Some Fake Data

From : https://cran.r-project.org/web/packages/sf/vignettes/sf1.html

```{r}
p1 <- rbind(c(0,0), c(1,0), c(3,2), c(2,4), c(1,4), c(0,0))
p2 <- rbind(c(1,1), c(1,2), c(2,2), c(1,1))
pol <-st_polygon(list(p1,p2))
p3 <- rbind(c(3,0), c(4,0), c(4,1), c(3,1), c(3,0))
p4 <- rbind(c(3.3,0.3), c(3.8,0.3), c(3.8,0.8), c(3.3,0.8), c(3.3,0.3))[5:1,]
p5 <- rbind(c(3,3), c(4,2), c(4,3), c(3,3))
p6 <- rbind(c(3,1), c(3.5,2), c(4,1), c(3,1))
(mpol <- st_multipolygon(list(list(p1,p2), list(p3,p4), list(p5))))
my_sf <- st_sfc(mpol, 
                st_multipolygon(list(list(p6)))
my_pol <- st_sfc(pol,
                 st_polygon(list(p6)))
)
```
# Plot the fake data
```{r}
plot(mpol)
```
# Combining
# st_multipolygon
```{r}
holes <- my_sf %>%
  st_union() %>%
  flatten() %>%
  map(~.[-1]) %>%
  flatten()

islands <- my_sf %>%
  st_union() %>%
  flatten() %>%
  map(~.[1]) %>%
  flatten() 

library(RTriangle)
my_sf %>%
  st_union() %>%
  flatten() %>%
  map(function(a_polygon){
    island <- a_polygon[1] 
    holes <- a_polygon[-1]
    hole_centroids <- map(holes, ~st_centroid(st_polygon(list(.))))
    hole_centroids

    # the island vertexes needs to be segments that are on the boundary
      

  })   
unioned_df <-  
  my_sf %>%
  st_union() %>%
  flatten()

st_centroid(st_polygon(unioned_df[[1]][[1]]))
    
    a_polygon <- unioned_df[[1]]
    island <- a_polygon[1] 
    holes <- a_polygon[-1]
    hole_centroids <- map(holes, ~st_centroid(st_polygon(list(.))))
    hole_centroids[[1]]
    all_holes_stacked <- reduce(holes, rbind)
    
    island[, 3]
```
# st_polygon
```{r}
my_pol %>%
  st_union()

```